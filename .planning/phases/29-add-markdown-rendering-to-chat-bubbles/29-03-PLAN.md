---
phase: 29-add-markdown-rendering-to-chat-bubbles
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/features/chat-page.tsx
  - src/styles/index.css
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Code blocks have dark background and proper syntax highlighting"
  artifacts:
    - path: "src/components/features/chat-page.tsx"
      provides: "ReactMarkdown with rehype-highlight plugin"
      contains: "rehypeHighlight"
    - path: "src/styles/index.css"
      provides: "Syntax highlighting CSS theme"
      contains: "@import 'highlight.js/styles/github-dark.css'"
  key_links:
    - from: "src/components/features/chat-page.tsx"
      to: "react-markdown"
      via: "remarkPlugins={[remarkGfm, rehypeHighlight]}"
      pattern: "remarkPlugins"
---

<objective>
Wire up rehype-highlight for code block syntax highlighting in assistant messages.

Purpose: Fix the missing syntax highlighting identified in verification - rehype-highlight was installed but never connected.
Output: Code blocks in assistant messages display colored syntax highlighting using github-dark theme.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-add-markdown-rendering-to-chat-bubbles/29-VERIFICATION.md
@.planning/phases/29-add-markdown-rendering-to-chat-bubbles/29-02-SUMMARY.md

@src/components/features/chat-page.tsx
@src/styles/index.css
</context>

<tasks>

<task type="auto">
  <name>Wire up rehype-highlight for syntax highlighting</name>
  <files>src/components/features/chat-page.tsx, src/styles/index.css</files>
  <action>
    **Gap to fix:** rehype-highlight was installed in plan 29-01 but never connected in plan 29-02 execution. Code blocks render with dark background but no syntax colors.

    **1. Import rehype-highlight in chat-page.tsx:**
    Add after line 4 (after remarkGfm import):
    ```typescript
    import rehypeHighlight from 'rehype-highlight'
    ```

    **2. Add rehypeHighlight to remarkPlugins array on line 36:**
    Change from:
    ```typescript
    <ReactMarkdown remarkPlugins={[remarkGfm]} components={markdownComponents}>
    ```
    To:
    ```typescript
    <ReactMarkdown remarkPlugins={[remarkGfm, rehypeHighlight]} components={markdownComponents}>
    ```

    **3. Import highlight.js CSS theme in src/styles/index.css:**
    Add after line 3 (after @tailwind utilities):
    ```css
    @import 'highlight.js/styles/github-dark.css';
    ```

    **Why github-dark.css:** Matches app's dark theme (#09090b background, white/gray text). The github-dark theme is a proven, high-contrast dark theme suitable for code blocks.
  </action>
  <verify>
    1. `grep -n "rehypeHighlight" src/components/features/chat-page.tsx` - shows import on line 5
    2. `grep -n "rehypeHighlight" src/components/features/chat-page.tsx` - shows in remarkPlugins array
    3. `grep "github-dark" src/styles/index.css` - shows CSS import present
    4. `npm run typecheck` - passes with no errors
    5. `npm run lint` - passes with no errors
  </verify>
  <done>
    rehype-highlight imported, added to remarkPlugins, and github-dark CSS theme imported. Code blocks will now display syntax colors (keywords in one color, strings in another, etc.) not just monochrome text.
  </done>
</task>

</tasks>

<verification>
1. Check that rehype-highlight is imported in chat-page.tsx
2. Check that rehypeHighlight appears in remarkPlugins array
3. Check that github-dark.css is imported in index.css
4. Verify npm run typecheck passes
5. Verify npm run lint passes
</verification>

<success_criteria>
Code blocks in assistant messages display colored syntax highlighting (different colors for keywords, strings, comments, etc.) using the github-dark theme, matching the app's dark color scheme.
</success_criteria>

<output>
After completion, create `.planning/phases/29-add-markdown-rendering-to-chat-bubbles/29-03-SUMMARY.md`
</output>
