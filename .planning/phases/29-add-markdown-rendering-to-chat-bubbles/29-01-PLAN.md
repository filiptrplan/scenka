---
phase: 29-add-markdown-rendering-to-chat-bubbles
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/lib/markdown-components.ts
autonomous: true

must_haves:
  truths:
    - "react-markdown, remark-gfm, and rehype-highlight are installed in package.json"
    - "src/lib/markdown-components.ts exports styled dark-theme components"
    - "Components include h1, h2, h3, p, ul, ol, li, code, pre, a, strong, em, blockquote"
    - "All components use dark theme colors matching the app's design"
    - "Code blocks have inline and block variants"
  artifacts:
    - path: "package.json"
      provides: "Markdown library dependencies"
      contains: "react-markdown"
    - path: "src/lib/markdown-components.ts"
      provides: "Styled markdown components"
      exports: ["markdownComponents"]
  key_links:
    - from: "package.json"
      to: "react-markdown library"
      via: "dependencies field"
      pattern: "react-markdown.*:.*\\d+\\.\\d+\\.\\d+"
---

<objective>
Install markdown rendering libraries and create styled dark-theme components for assistant messages.

Purpose: Provide the foundation for rendering formatted markdown content in chat responses, including headers, lists, code blocks, and links. Components must match the app's dark theme (#09090b background).

Output: Updated package.json with markdown libraries and new src/lib/markdown-components.ts with dark-themed styled components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/RESEARCH.md
@src/components/features/chat-page.tsx

# Reference: Research-recommended stack
- react-markdown: 10.1.0
- remark-gfm: 4.0.1
- rehype-highlight: 7.0.2

# Current styling context
- Dark theme: #09090b background
- User messages: bg-blue-600 text-white
- Assistant messages: bg-gray-700 text-gray-100
- Text colors: white, gray-100, gray-200, gray-300, gray-400
- Link color: blue-400 with hover blue-300
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install markdown libraries</name>
  <files>package.json</files>
  <action>
    Run the following command to install the markdown rendering libraries:

    ```bash
    pnpm add react-markdown remark-gfm rehype-highlight
    ```

    This adds:
    - react-markdown (10.1.0): Core markdown to React renderer
    - remark-gfm (4.0.1): GitHub Flavored Markdown (tables, tasklists, strikethrough)
    - rehype-highlight (7.0.2): Code syntax highlighting for code blocks

    DO NOT install other markdown libraries (marked, markdown-to-jsx, etc.) as research confirms react-markdown is the industry standard with better security and React integration.
  </action>
  <verify>
    grep -E "react-markdown|remark-gfm|rehype-highlight" package.json
  </verify>
  <done>
    All three libraries appear in package.json dependencies with versions matching or above research recommendations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create dark-themed markdown components</name>
  <files>src/lib/markdown-components.ts</files>
  <action>
    Create src/lib/markdown-components.ts with styled components for all markdown elements. Follow the dark theme patterns from RESEARCH.md code examples and match the app's existing styling (assistant messages use bg-gray-700 text-gray-100).

    Component requirements:
    - h1: text-2xl font-bold mb-3 text-white
    - h2: text-xl font-semibold mb-2 text-gray-100
    - h3: text-lg font-semibold mb-2 text-gray-200
    - p: mb-3 text-gray-300 leading-relaxed
    - ul: list-disc pl-5 mb-3 text-gray-300 space-y-1
    - ol: list-decimal pl-5 mb-3 text-gray-300 space-y-1
    - li: mb-1
    - code (inline): bg-gray-800 px-1.5 py-0.5 rounded text-sm font-mono text-blue-300
    - pre: bg-gray-800 p-4 rounded-lg overflow-x-auto my-3 (contains code)
    - a: text-blue-400 hover:text-blue-300 underline, target="_blank", rel="noopener noreferrer"
    - strong: font-semibold text-white
    - em: italic text-gray-200
    - blockquote: border-l-4 border-gray-600 pl-4 italic text-gray-400 my-3

    Export the components object as `markdownComponents` with proper TypeScript types.

    Reference RESEARCH.md lines 189-231 for the exact component structure with TypeScript types.
  </action>
  <verify>
    pnpm typecheck
  </verify>
  <done>
    src/lib/markdown-components.ts exists, exports markdownComponents object with all required elements (h1, h2, h3, p, ul, ol, li, code, a, strong, em, blockquote), TypeScript compiles without errors.
  </done>
</task>

</tasks>

<verification>
- [ ] npm run typecheck passes (no TypeScript errors)
- [ ] package.json contains all three markdown libraries
- [ ] markdownComponents object exports all required elements with proper types
- [ ] All components use dark theme colors (white, gray-100 through gray-400)
- [ ] Code block has both inline and block variants
- [ ] Links have target="_blank" and rel="noopener noreferrer"
</verification>

<success_criteria>
Markdown libraries installed and dark-themed styled components created, ready for integration into MessageBubble.
</success_criteria>

<output>
After completion, create `.planning/phases/29-add-markdown-rendering-to-chat-bubbles/29-01-SUMMARY.md`
</output>
