---
phase: 23-refocus-coach-on-technique
plan: 06
type: execute
wave: 3
depends_on: [23-01, 23-02, 23-03, 23-04, 23-05]
files_modified: [src/services/coach.ts, src/components/features/coach-page.tsx]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Client type definition includes measurable_outcome field"
    - "UI displays measurable_outcome for each drill"
    - "Type consistency between Edge Function and client"
  artifacts:
    - path: "src/services/coach.ts"
      provides: "Type definition with measurable_outcome"
      contains: "export interface GenerateRecommendationsResponse"
      contains: "measurable_outcome"
    - path: "src/components/features/coach-page.tsx"
      provides: "UI rendering of measurable_outcome"
      contains: "drill.measurable_outcome"
  key_links:
    - from: "src/services/coach.ts"
      to: "Edge Function drill schema"
      via: "measurable_outcome field"
      pattern: "measurable_outcome"
    - from: "src/components/features/coach-page.tsx"
      to: "GenerateRecommendationsResponse"
      via: "drill.measurable_outcome"
      pattern: "drill\\.measurable_outcome"
---

<objective>
Add measurable_outcome field to client types and UI to match Edge Function drill schema.

Purpose: The Edge Function enforces measurable_outcome as a required field for all drills, but the client doesn't expect or display this field. Users can't see the measurable outcomes needed to track drill progress.

Output: Updated GenerateRecommendationsResponse interface and UI that displays measurable_outcome for each drill.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-refocus-coach-on-technique/23-VERIFICATION.md

@src/services/coach.ts
@src/components/features/coach-page.tsx
@supabase/functions/openrouter-coach/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add measurable_outcome to GenerateRecommendationsResponse</name>
  <files>src/services/coach.ts</files>
  <action>
Update the GenerateRecommendationsResponse interface to include measurable_outcome field:

1. Find the GenerateRecommendationsResponse interface (around lines 25-34)
2. Add `measurable_outcome: string` field to the drill object type
3. The field should be required (non-optional) to match Edge Function validation
4. Place it after the `rest: string` field

The interface should look like:
```typescript
export interface GenerateRecommendationsResponse {
  weekly_focus: string
  drills: Array<{
    name: string
    description: string
    sets: number
    reps: string
    rest: string
    measurable_outcome: string
  }>
}
```

This matches the Edge Function drill schema at lines 298-303 which enforces measurable_outcome as a required field with min 10 chars.

Do NOT modify any other interfaces or types in this file.
</action>
  <verify>grep -A 8 "export interface GenerateRecommendationsResponse" src/services/coach.ts | grep "measurable_outcome"</verify>
  <done>GenerateRecommendationsResponse includes measurable_outcome field in drill type</done>
</task>

<task type="auto">
  <name>Task 2: Display measurable_outcome in coach-page.tsx</name>
  <files>src/components/features/coach-page.tsx</files>
  <action>
Update the UI to display measurable_outcome for each drill:

1. Find the drill rendering section (around lines 184-205)
2. Add a new paragraph after the description paragraph (after line 201)
3. Render the measurable_outcome field with styling that distinguishes it from the description
4. Use the existing text-[#bbb] color for consistency with other metadata

Add this after the description:
```typescript
{drill.measurable_outcome && (
  <p className="text-sm text-green-400/80 leading-relaxed font-mono mt-2 pt-2 border-t border-white/10">
    Goal: {drill.measurable_outcome}
  </p>
)}
```

Key design decisions:
- Use conditional rendering with `drill.measurable_outcome &&` to handle old cached recommendations
- Use text-green-400/80 to visually distinguish the goal/outcome from the description
- Use font-mono for code-like feel (measurable outcomes are specific metrics)
- Add border-top separator to visually separate outcome from description
- Add mt-2 pt-2 for spacing above and below the separator

The conditional rendering is important because existing cached recommendations won't have this field until they regenerate.

Do NOT modify any other parts of the component.
</action>
  <verify>grep "measurable_outcome" src/components/features/coach-page.tsx</verify>
  <done>UI displays measurable_outcome field for each drill with appropriate styling</done>
</task>

</tasks>

<verification>
- [ ] GenerateRecommendationsResponse interface includes measurable_outcome field
- [ ] UI renders measurable_outcome with conditional rendering
- [ ] TypeScript compiles without errors (pnpm typecheck)
- [ ] Styling distinguishes measurable_outcome from description
- [ ] Conditional rendering handles old cached recommendations
</verification>

<success_criteria>
Client type definition matches Edge Function drill schema; UI displays measurable_outcome for each drill when available.
</success_criteria>

<output>
After completion, create `.planning/phases/23-refocus-coach-on-technique/23-06-SUMMARY.md`
</output>
