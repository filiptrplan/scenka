---
phase: 24-projecting-focus-recommendations
plan: 03
type: execute
wave: 3
depends_on: ["24-02"]
files_modified:
  - src/components/features/coach-page.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Projecting Focus section displays below Training Drills section"
    - "Each focus area card shows focus_area, description, grade_guidance badge, and rationale"
    - "Empty state displays 'No projecting focus available' message"
    - "Styling matches existing sections (FormSection, same header pattern)"
    - "Backward compatible with old recommendations missing projecting_focus"
  artifacts:
    - path: "src/components/features/coach-page.tsx"
      provides: "Coach recommendations UI with projecting focus section"
      contains: "Projecting Focus"
  key_links:
    - from: "coach-page.tsx"
      to: "GenerateRecommendationsResponse"
      via: "Type-safe data access"
      pattern: "recommendations.content.projecting_focus"
    - from: "Projecting Focus section"
      to: "Edge Function response"
      via: "TanStack Query cache"
      pattern: "useCoachRecommendations"
---

<objective>
Add Projecting Focus section to coach recommendations tab UI.

Purpose: Display AI-generated projecting focus recommendations alongside weekly focus and drills, helping users select boulders to project on each week.
Output: New Projecting Focus section in coach-page.tsx with cards showing focus area, description, grade guidance, and rationale.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/24-projecting-focus-recommendations/24-CONTEXT.md
@.planning/phases/24-projecting-focus-recommendations/24-RESEARCH.md

@src/components/features/coach-page.tsx
@src/services/coach.ts
</context>

<tasks>

<task type="auto">
  <name>Import ProjectingFocus type and update recommendations type</name>
  <files>src/components/features/coach-page.tsx</files>
  <action>
    In src/components/features/coach-page.tsx, update type imports:

    Find the imports from @/services/coach (around line 4). Add ProjectingFocus to the import statement:

    Change from:
    ```typescript
    import { generateRecommendations } from '@/services/coach'
    ```

    To:
    ```typescript
    import { generateRecommendations, type ProjectingFocus } from '@/services/coach'
    ```

    Then update the useCoachRecommendations hook return type annotation (around line 37). Change:
    ```typescript
    useQuery<GenerateRecommendationsResponse>({
    ```

    To include projecting_focus field:
    ```typescript
    useQuery<GenerateRecommendationsResponse & { projecting_focus?: ProjectingFocus[] }>({
    ```

    This intersection type adds projecting_focus to the existing GenerateRecommendationsResponse without requiring changes to the service layer, maintaining backward compatibility while enabling type-safe access in the component.
  </action>
  <verify>
    grep "type ProjectingFocus" src/components/features/coach-page.tsx
  </verify>
  <done>
    coach-page.tsx imports ProjectingFocus type and extends recommendations type with projecting_focus field
  </done>
</task>

<task type="auto">
  <name>Add Projecting Focus section below Training Drills</name>
  <files>src/components/features/coach-page.tsx</files>
  <action>
    In src/components/features/coach-page.tsx, add Projecting Focus section:

    After the Training Drills section (around line 211, before Action Buttons section), add:

    ```tsx
    {/* Projecting Focus Section */}
    <section>
      <div className="flex items-center gap-4 mb-6">
        <div className="h-1 flex-1 bg-purple-500" />
        <h2 className="text-3xl font-black tracking-tighter uppercase">Projecting Focus</h2>
        <div className="h-1 flex-1 bg-purple-500" />
      </div>

      {(recommendations.content?.projecting_focus || []).length === 0 ? (
        <FormSection>
          <p className="text-center text-[#888]">No projecting focus available</p>
        </FormSection>
      ) : (
        (recommendations.content?.projecting_focus || []).map(
          (focus: ProjectingFocus, index: number) => (
            <FormSection key={index} className="mb-4">
              <div className="flex items-start justify-between mb-3">
                <h3 className="text-xl font-black uppercase">
                  {focus.focus_area || 'Focus Area'}
                </h3>
                <Badge
                  variant="outline"
                  className="text-xs font-mono border-white/20 text-[#ccc]"
                >
                  {focus.grade_guidance || 'No grade guidance'}
                </Badge>
              </div>
              <p className="text-sm text-[#bbb] leading-relaxed mb-3">
                {focus.description || 'No description available'}
              </p>
              <p className="text-xs text-purple-400/80 leading-relaxed font-mono">
                Why: {focus.rationale || 'No rationale provided'}
              </p>
            </FormSection>
          )
        )
      )}
    </section>
    ```

    This follows the exact same pattern as Weekly Focus and Training Drills sections:
    - Purple divider color (matches Recent Successes in Pattern Analysis tab)
    - FormSection component for cards
    - Badge for grade_guidance
    - Empty state with optional chaining fallback
    - Mobile-first responsive design
    - Type-safe ProjectingFocus[] usage (no `as any`)

    NOTE: The `|| []` fallback ensures backward compatibility with old cached recommendations that don't have projecting_focus field.
  </action>
  <verify>
    grep -A 5 "Projecting Focus" src/components/features/coach-page.tsx | head -5
  </verify>
  <done>
    Projecting Focus section displays after Training Drills with purple header styling, FormSection cards, and shows focus_area, description, grade_guidance badge, and rationale using ProjectingFocus type
  </done>
</task>

</tasks>

<verification>
1. ProjectingFocus type imported from @/services/coach
2. recommendations type includes projecting_focus field via intersection type
3. Projecting Focus section appears after Training Drills section (before Action Buttons)
4. Header uses purple divider color matching "Recent Successes" section style
5. Each focus area displays in FormSection card with focus_area heading, grade_guidance badge, description text, and rationale
6. Empty state shows "No projecting focus available" message
7. Type-safe ProjectingFocus[] used in map function (no `as any` casting)
8. UI builds successfully: `pnpm build` completes without errors
</verification>

<success_criteria>
Projecting Focus section added to coach recommendations tab with proper styling, empty state handling, backward compatibility, and type-safe ProjectingFocus usage.
</success_criteria>

<output>
After completion, create `.planning/phases/24-projecting-focus-recommendations/24-03-SUMMARY.md`
</output>
